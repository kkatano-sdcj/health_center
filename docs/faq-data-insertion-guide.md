# FAQ ãƒ‡ãƒ¼ã‚¿ç™»éŒ²ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

FAQ.csvã®å†…å®¹ã‚’Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®FAQãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ã™ã‚‹ãŸã‚ã®æ‰‹é †æ›¸ã§ã™ã€‚
10ä»¶ã®FAQãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’é©åˆ‡ãªã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã—ã¦ç™»éŒ²ã—ã¾ã™ã€‚

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ¦‚è¦

### ç™»éŒ²å¯¾è±¡ãƒ‡ãƒ¼ã‚¿
- **ç·ä»¶æ•°**: 10ä»¶ã®FAQãƒ¬ã‚³ãƒ¼ãƒ‰
- **æœŸé–“**: 2022å¹´6æœˆã€œ2024å¹´5æœˆ
- **ã‚«ãƒ†ã‚´ãƒª**: 10ç¨®é¡ã®åŒ»ç™‚æ¥­å‹™ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡

### ã‚«ãƒ†ã‚´ãƒªãƒãƒƒãƒ”ãƒ³ã‚°
| CSV ã‚«ãƒ†ã‚´ãƒª | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ã‚«ãƒ†ã‚´ãƒª | ã‚«ãƒ†ã‚´ãƒªID |
|-------------|-------------------|-----------|
| ç”»é¢è¡¨ç¤º | DISPLAY | 10000000-0000-0000-0000-000000000013 |
| åç´ãƒ»è«‹æ±‚ | BILLING | 10000000-0000-0000-0000-000000000004 |
| çµ±è¨ˆãƒ»DWH | STATISTICS | 10000000-0000-0000-0000-000000000006 |
| DPC | DPC | 10000000-0000-0000-0000-000000000003 |
| ã‚·ã‚¹ãƒ†ãƒ  | SYSTEM | 10000000-0000-0000-0000-000000000011 |
| ä¼šè¨ˆã‚«ãƒ¼ãƒ‰ | ACCOUNTING | 10000000-0000-0000-0000-000000000001 |
| ãƒ¬ã‚»ãƒ—ãƒˆ | RECEIPT | 10000000-0000-0000-0000-000000000002 |
| ãƒã‚¹ã‚¿ | MASTER | 10000000-0000-0000-0000-000000000005 |
| å¤–æ¥ | OUTPATIENT | 10000000-0000-0000-0000-000000000009 |
| å…¥é™¢ | INPATIENT | 10000000-0000-0000-0000-000000000010 |

## ğŸš€ å®Ÿè¡Œæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ— 1: å‰ææ¡ä»¶ã®ç¢ºèª

ä»¥ä¸‹ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
- âœ… Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ§‹ç¯‰æ¸ˆã¿
- âœ… åŸºæœ¬ã‚¹ã‚­ãƒ¼ãƒï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ã‚«ãƒ†ã‚´ãƒªï¼‰ãŒä½œæˆæ¸ˆã¿
- âœ… Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚ã‚Š

### ã‚¹ãƒ†ãƒƒãƒ— 2: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã‚’é–‹ãï¼š
   ```
   https://supabase.com/dashboard/project/ivpwniudlxktnruxnmfy
   ```

2. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€Œ**SQL Editor**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### ã‚¹ãƒ†ãƒƒãƒ— 3: FAQãƒ‡ãƒ¼ã‚¿ç™»éŒ²SQLã®å®Ÿè¡Œ

1. **æ–°ã—ã„ã‚¯ã‚¨ãƒªã‚¿ãƒ–ã‚’ä½œæˆ**

2. **ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§SQLãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’è¡¨ç¤º**ï¼š
   ```bash
   cat supabase/migrations/002_insert_faq_data.sql
   ```

3. **SQLãƒ•ã‚¡ã‚¤ãƒ«ã®å…¨å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼** (Ctrl+A â†’ Ctrl+C)

4. **SQL Editorã«è²¼ã‚Šä»˜ã‘** (Ctrl+V)

5. **ã€ŒRUNã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**ã—ã¦å®Ÿè¡Œ

### ã‚¹ãƒ†ãƒƒãƒ— 4: å®Ÿè¡Œçµæœã®ç¢ºèª

å®Ÿè¡Œå®Œäº†å¾Œã€ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã§ç™»éŒ²çµæœã‚’ç¢ºèªï¼š

```sql
-- ç™»éŒ²ã•ã‚ŒãŸFAQã®ä¸€è¦§ç¢ºèª
SELECT 
    f.record_number,
    f.question_title,
    fc.name as category_name,
    f.status,
    f.question_date
FROM faqs f
JOIN faq_categories fc ON f.category_id = fc.id
ORDER BY f.question_date;

-- ã‚«ãƒ†ã‚´ãƒªåˆ¥FAQæ•°ã®ç¢ºèª
SELECT 
    fc.name as category_name,
    fc.faq_count,
    COUNT(f.id) as actual_count
FROM faq_categories fc
LEFT JOIN faqs f ON fc.id = f.category_id
GROUP BY fc.id, fc.name, fc.faq_count
ORDER BY fc.sort_order;

-- å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¢ºèª
SELECT 
    record_number,
    question_title,
    CASE 
        WHEN search_vector IS NOT NULL THEN 'âœ… ä½œæˆæ¸ˆã¿'
        ELSE 'âŒ æœªä½œæˆ'
    END as search_index_status
FROM faqs
ORDER BY question_date;
```

## ğŸ“„ ç™»éŒ²ã•ã‚Œã‚‹FAQãƒ‡ãƒ¼ã‚¿è©³ç´°

### FAQä¸€è¦§

| è¨˜éŒ²ç•ªå· | ã‚¿ã‚¤ãƒˆãƒ« | ã‚«ãƒ†ã‚´ãƒª | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | è³ªå•æ—¥ |
|---------|---------|----------|-----------|--------|
| IIJI-20220607-000042 | ä¼šè¨ˆã‚«ãƒ¼ãƒ‰ç”»é¢ã®è¡¨ç¤ºç•°å¸¸ã«ã¤ã„ã¦ | ç”»é¢è¡¨ç¤º | è§£æ±ºæ¸ˆã¿ | 2022-06-07 |
| IIJI-20220615-000072 | åç´ç´°ç¯€é›†è¨ˆã®èª¤ã‚Šã«ã¤ã„ã¦ | åç´ãƒ»è«‹æ±‚ | è§£æ±ºæ¸ˆã¿ | 2022-06-15 |
| IIJI-20220808-000275 | ç¨¼åƒé¡çµ±è¨ˆï¼ˆé€Ÿå ±ï¼‰ã§ç‰¹å®šã®æ‚£è€…ã§ãƒ‡ãƒ¼ã‚¿ãŒä½œæˆã•ã‚Œãªã„ | çµ±è¨ˆãƒ»DWH | è§£æ±ºæ¸ˆã¿ | 2022-08-08 |
| IIJI-20221028-000534 | åŒ–å­¦ç™‚æ³•è–¬å‰¤ã®ï¼¤ï¼°ï¼£ãƒ¬ã‚»ãƒ—ãƒˆã¸ã®å°å­—ã«ã¤ã„ã¦ | DPC | è§£æ±ºæ¸ˆã¿ | 2022-10-28 |
| IIJI-20221028-000535 | HOPE X-W V12ã«é–¢ã™ã‚‹å•ã„åˆã‚ã› | ã‚·ã‚¹ãƒ†ãƒ  | è§£æ±ºæ¸ˆã¿ | 2022-10-28 |
| IIJI-20221101-000542 | ä¼šè¨ˆã‚«ãƒ¼ãƒ‰æ¥­å‹™ã«é–¢ã™ã‚‹å•ã„åˆã‚ã› | ä¼šè¨ˆã‚«ãƒ¼ãƒ‰ | å¯¾å¿œä¸­ | 2022-11-01 |
| IIJI-20231215-001991 | ãƒ¬ã‚»ãƒ—ãƒˆä½œæˆæ™‚ã®ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ | ãƒ¬ã‚»ãƒ—ãƒˆ | è§£æ±ºæ¸ˆã¿ | 2023-12-15 |
| IIJI-20240115-002047 | ç‚¹æ•°ãƒã‚¹ã‚¿ã®è¨­å®šã«é–¢ã™ã‚‹å•ã„åˆã‚ã› | ãƒã‚¹ã‚¿ | è§£æ±ºæ¸ˆã¿ | 2024-01-15 |
| M-20240119-50483 | å¤–æ¥å—ä»˜æ™‚ã®ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ã„ã¦ | å¤–æ¥ | è§£æ±ºæ¸ˆã¿ | 2024-01-19 |
| IIJI-20240509-002395 | å…¥é™¢æ‚£è€…ã®è»¢ç§‘å‡¦ç†ã«é–¢ã™ã‚‹è³ªå• | å…¥é™¢ | è§£æ±ºæ¸ˆã¿ | 2024-05-09 |

## âœ… æœŸå¾…ã•ã‚Œã‚‹çµæœ

### ç™»éŒ²å®Œäº†å¾Œã®çŠ¶æ…‹
- **FAQãƒ¬ã‚³ãƒ¼ãƒ‰æ•°**: 10ä»¶
- **ä½¿ç”¨ã‚«ãƒ†ã‚´ãƒªæ•°**: 10ã‚«ãƒ†ã‚´ãƒª
- **è§£æ±ºæ¸ˆã¿FAQ**: 9ä»¶
- **å¯¾å¿œä¸­FAQ**: 1ä»¶
- **å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: å…¨FAQã§ä½œæˆæ¸ˆã¿

### æ©Ÿèƒ½ç¢ºèª
ä»¥ä¸‹ã®æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

1. **ã‚«ãƒ†ã‚´ãƒªåˆ¥FAQè¡¨ç¤º**
2. **å…¨æ–‡æ¤œç´¢æ©Ÿèƒ½**
3. **FAQè©³ç´°è¡¨ç¤º**
4. **é–¢é€£ãƒã‚±ãƒƒãƒˆç•ªå·ã®è¡¨ç¤º**
5. **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆè³ªå•è€…ãƒ»å¯¾å¿œè€…æƒ…å ±ï¼‰ã®è¡¨ç¤º**

## âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•

#### ã‚¨ãƒ©ãƒ¼: "duplicate key value violates unique constraint"
**åŸå› **: åŒã˜record_numberã®FAQãŒæ—¢ã«å­˜åœ¨  
**å¯¾å‡¦**: æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã€é‡è¤‡ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†å®Ÿè¡Œ

```sql
-- é‡è¤‡ç¢ºèª
SELECT record_number, COUNT(*) 
FROM faqs 
GROUP BY record_number 
HAVING COUNT(*) > 1;

-- é‡è¤‡å‰Šé™¤ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
DELETE FROM faqs WHERE record_number = 'IIJI-20220607-000042';
```

#### ã‚¨ãƒ©ãƒ¼: "foreign key constraint fails"
**åŸå› **: ã‚«ãƒ†ã‚´ãƒªIDãŒå­˜åœ¨ã—ãªã„  
**å¯¾å‡¦**: ã‚«ãƒ†ã‚´ãƒªãƒ†ãƒ¼ãƒ–ãƒ«ã®å­˜åœ¨ç¢ºèª

```sql
-- ã‚«ãƒ†ã‚´ãƒªå­˜åœ¨ç¢ºèª
SELECT id, code, name FROM faq_categories ORDER BY sort_order;
```

#### å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½œæˆã•ã‚Œãªã„
**åŸå› **: search_vectoræ›´æ–°å‡¦ç†ã®å¤±æ•—  
**å¯¾å‡¦**: æ‰‹å‹•ã§search_vectorã‚’æ›´æ–°

```sql
-- å…¨FAQã®search_vectoræ›´æ–°
UPDATE faqs SET search_vector = to_tsvector('english',
    COALESCE(question_title, '') || ' ' ||
    COALESCE(question_content, '') || ' ' ||
    COALESCE(answer_content, '') || ' ' ||
    COALESCE(package_name, '')
);
```

## ğŸ” ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

### ç™»éŒ²å¾Œã®æ¤œè¨¼ã‚¯ã‚¨ãƒª

```sql
-- 1. åŸºæœ¬çµ±è¨ˆ
SELECT 
    COUNT(*) as total_faqs,
    COUNT(CASE WHEN status = 'resolved' THEN 1 END) as resolved_faqs,
    COUNT(CASE WHEN status = 'in_progress' THEN 1 END) as in_progress_faqs,
    COUNT(DISTINCT category_id) as used_categories
FROM faqs;

-- 2. æ—¥ä»˜ç¯„å›²ç¢ºèª
SELECT 
    MIN(question_date) as earliest_question,
    MAX(question_date) as latest_question,
    COUNT(*) as total_count
FROM faqs;

-- 3. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆ¥é›†è¨ˆ
SELECT 
    COALESCE(package_name, 'æœªæŒ‡å®š') as package,
    COUNT(*) as faq_count
FROM faqs
GROUP BY package_name
ORDER BY faq_count DESC;

-- 4. æ¤œç´¢æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
SELECT 
    record_number,
    question_title,
    ts_rank(search_vector, plainto_tsquery('english', 'ä¼šè¨ˆ')) as rank
FROM faqs
WHERE search_vector @@ plainto_tsquery('english', 'ä¼šè¨ˆ')
ORDER BY rank DESC;
```

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

FAQãƒ‡ãƒ¼ã‚¿ç™»éŒ²å®Œäº†å¾Œã®æ¨å¥¨ä½œæ¥­ï¼š

1. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é€£æºãƒ†ã‚¹ãƒˆ**
   - FAQæ¤œç´¢æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
   - ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®ç¢ºèª
   - è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½ã®ç¢ºèª

2. **è¿½åŠ ãƒ‡ãƒ¼ã‚¿æŠ•å…¥**
   - æ–°ã—ã„FAQãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®è¿½åŠ æŠ•å…¥
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ–°è¦FAQç™»éŒ²ãƒ†ã‚¹ãƒˆ

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª**
   - æ¤œç´¢é€Ÿåº¦ã®æ¸¬å®š
   - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŠ¹æœã®ç¢ºèª
   - å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ã‚¬ã‚¤ãƒ‰](/docs/supabase-database-setup-guide.md)
- [FAQãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆæ›¸](/docs/faq-user-schema-design.md)
- [ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¿®æ­£ãƒ­ã‚°](/docs/migration-fix-log.md)
- [FAQãƒ‡ãƒ¼ã‚¿ç™»éŒ²SQL](/supabase/migrations/002_insert_faq_data.sql)

---

**ä½œæˆæ—¥**: 2025-01-03  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿**: FAQ.csv (10ä»¶)  
**å®Ÿè¡Œç’°å¢ƒ**: Supabase PostgreSQL
